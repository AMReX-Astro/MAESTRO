These are working notes for the low density parameters in {\tt MAESTRO}.

\section{Computing the Cutoff Values}

At several points in the algorithm, we compute {\tt anelastic\_cutoff\_coord}, 
{\tt base\_cutoff\_density\_coord}, and {\tt burning\_cutoff\_density\_coord} by 
setting the corresponding coordinate equal to $r$ as soon as $\rho_0(r)$ is less than 
or equal to that particular cutoff value.  We set the coordinates at the following 
points in the code:

\begin{itemize}

\item In {\tt probin}, {\tt anelastic\_cutoff} and {\tt base\_cutoff\_density} are
  set to $3\times 10^6$ by default.

\item In {\tt probin}, {\tt burning\_cutoff\_density} is set to 
  {\tt base\_cutoff\_density}.  There is no option to set 
  {\tt burning\_cutoff\_density} using the inputs file.

\item After we initialize the base state in {\tt varden}.

\item At the beginning of {\tt advance\_timestep}.

\item After each call to {\tt advect\_base\_dens}.

\item After each call to {\tt correct\_base} in spherical 
  (or call to {\tt average} in plane-parallel).

\end{itemize}

\section{anelastic\_cutoff}\label{Sec:Anelastic Cutoff}

\begin{itemize}

\item In {\tt init\_base\_state}, we abort the program if 
  {\tt anelastic\_cutoff} $<$ {\tt base\_cutoff\_density}.

\item In {\tt make\_div\_coeff}, we change how we compute {\tt div\_coeff} 
  for $r\in[{\tt anelastic\_cutoff\_coord},{\tt r\_end\_coord}]$.

\item In {\tt make\_psi} for plane-parallel, we only compute $\psi$ for 
  $r\in[{\tt r\_start\_coord},{\tt anelastic\_cutoff\_coord}-1]$.

\item in {\tt make\_S}, we set {\tt delta\_gamma1\_term} and {\tt delta\_gamma1} 
  to zero for $r\in[{\tt anelastic\_cutoff\_coord},{\tt r\_end\_coord}]$.

\item In {\tt sponge}, {\tt anelastic\_cutoff} is used in a problem
  dependent way.

\end{itemize}

\section{base\_cutoff\_density}\label{Sec:Base Cutoff Density}

\begin{itemize}

\item In {\tt init\_base\_state}, we abort the program if {\tt
  anelastic\_cutoff} $<$ {\tt base\_cutoff\_density}.

\item In {\tt base\_state}, we compute a physical cutoff location,
  {\tt base\_cutoff\_density\_loc}, which is defined as the physical
  location of the first cell-center at the coarsest level for which
  $\rho_0 <$ {\tt base\_cutoff\_density}.  This is a trick used for making
  the data consistent for multiple level problems.

\item In {\tt base\_state}, when we are generating the initial
  background/base state, if we are above {\tt base\_cutoff\_density\_loc}, 
  just use the values for $\rho,T$, and $p$ at {\tt base\_cutoff\_density\_loc}.

\item In {\tt make\_hgrhs}, {\tt make\_macrhs}, and {\tt make\_w0}, 
  we only add the volume discrepancy for
  $r\in[{\tt r\_start\_coord},{\tt base\_cutoff\_density\_coord}-1]$.

\item In {\tt mkrhohforce} for plane-parallel, for
  $r\in[{\tt base\_cutoff\_density\_coord},{\tt r\_end\_coord}]$ we
  compute $\nabla p_0$ with a difference stencil instead of simply
  setting it to $\rho_0 g$.

\item In {\tt update\_scal}, if the new $\rho$ is less than 
  {\tt base\_cutoff\_density} and {\tt do\_eos\_h\_above\_cutoff},  
  we call the EOS to compute $h$.

\item In {\tt make\_grav}, if we are spherical, we do not add to the
  enclosed mass, $M(r)$ if $\rho$ is less than {\tt base\_cutoff\_density}.

\item In {\tt enforce\_HSE}, we set $p_0(r) = p_0(r-1)$ for 
  $r\in[{\tt base\_cutoff\_density\_coord}-1,{\tt r\_end\_coord}]$

\end{itemize}

\section{burning\_cutoff}

\begin{itemize}

\item In {\tt react\_state}, we only call the burner if 
  $\rho >$ {\tt burning\_cutoff\_density}.

\end{itemize}

